-- VLG UI LIBRARY
-- Mobile + PC
-- By VLG XITER (@Daniel)

local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local LocalPlayer = Players.LocalPlayer

local UILibrary = {}

-- ================= CREATE UI BASE =================
function UILibrary:CreateUI()
    local gui = Instance.new("ScreenGui")
    gui.Name = "VLG_UI"
    gui.Parent = LocalPlayer:WaitForChild("PlayerGui")
    gui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

    local Topo = Instance.new("Frame", gui)
    Topo.Size = UDim2.new(0, 300, 0, 26)
    Topo.Position = UDim2.new(0.5, -150, 0.2, 0)
    Topo.BackgroundColor3 = Color3.fromRGB(144, 0, 181)
    Topo.BorderSizePixel = 0

    Instance.new("UICorner", Topo).CornerRadius = UDim.new(0, 6)

    local Title = Instance.new("TextLabel", Topo)
    Title.Size = UDim2.new(1, -60, 1, 0)
    Title.Position = UDim2.new(0, 30, 0, 0)
    Title.BackgroundTransparency = 1
    Title.Text = "VLG XITER"
    Title.TextColor3 = Color3.new(1,1,1)
    Title.Font = Enum.Font.GothamBold
    Title.TextSize = 11
    Title.TextXAlignment = Left

    local OpenBtn = Instance.new("TextButton", Topo)
    OpenBtn.Size = UDim2.new(0, 26, 1, 0)
    OpenBtn.Text = "â‰¡"
    OpenBtn.TextColor3 = Color3.new(1,1,1)
    OpenBtn.BackgroundTransparency = 1
    OpenBtn.Font = Enum.Font.GothamBold
    OpenBtn.TextSize = 14

    local CloseBtn = Instance.new("TextButton", Topo)
    CloseBtn.Size = UDim2.new(0, 26, 1, 0)
    CloseBtn.Position = UDim2.new(1, -26, 0, 0)
    CloseBtn.Text = "X"
    CloseBtn.TextColor3 = Color3.new(1,1,1)
    CloseBtn.BackgroundTransparency = 1
    CloseBtn.Font = Enum.Font.GothamBold
    CloseBtn.TextSize = 11

    local Main = Instance.new("Frame", Topo)
    Main.Size = UDim2.new(1, 0, 0, 180)
    Main.Position = UDim2.new(0, 0, 1, 0)
    Main.BackgroundColor3 = Color3.fromRGB(35,35,35)
    Main.BorderSizePixel = 0
    Main.Visible = true
    Instance.new("UICorner", Main).CornerRadius = UDim.new(0, 6)

    local Layout = Instance.new("UIListLayout", Main)
    Layout.Padding = UDim.new(0, 6)

    Instance.new("UIPadding", Main).PaddingTop = UDim.new(0, 8)

    -- Open / Close
    OpenBtn.MouseButton1Click:Connect(function()
        Main.Visible = not Main.Visible
    end)

    CloseBtn.MouseButton1Click:Connect(function()
        gui.Enabled = false
    end)

    -- Drag (PC + Mobile)
    local dragging, dragStart, startPos
    Topo.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1
        or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = Topo.Position
        end
    end)

    UIS.InputChanged:Connect(function(input)
        if dragging then
            if input.UserInputType == Enum.UserInputType.MouseMovement
            or input.UserInputType == Enum.UserInputType.Touch then
                local delta = input.Position - dragStart
                Topo.Position = UDim2.new(
                    startPos.X.Scale,
                    startPos.X.Offset + delta.X,
                    startPos.Y.Scale,
                    startPos.Y.Offset + delta.Y
                )
            end
        end
    end)

    UIS.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1
        or input.UserInputType == Enum.UserInputType.Touch then
            dragging = false
        end
    end)

    return gui, Main, Title
end

-- ================= WINDOW =================
function UILibrary:CreateWindow(title)
    local gui, Main, Title = self:CreateUI()
    Title.Text = title

    local Window = {}

    -- ===== TOGGLE =====
    function Window:AddToggle(text, callback)
        local Toggle = Instance.new("Frame", Main)
        Toggle.Size = UDim2.new(1, -12, 0, 26)
        Toggle.BackgroundTransparency = 1

        local Label = Instance.new("TextLabel", Toggle)
        Label.Size = UDim2.new(1, -40, 1, 0)
        Label.BackgroundTransparency = 1
        Label.Text = text
        Label.TextColor3 = Color3.new(1,1,1)
        Label.Font = Enum.Font.GothamBold
        Label.TextSize = 10
        Label.TextXAlignment = Left

        local Button = Instance.new("TextButton", Toggle)
        Button.Size = UDim2.new(0, 22, 0, 22)
        Button.Position = UDim2.new(1, -22, 0.5, -11)
        Button.BackgroundColor3 = Color3.fromRGB(60,60,60)
        Button.Text = ""
        Instance.new("UICorner", Button).CornerRadius = UDim.new(0, 5)

        local On = false

        Button.MouseButton1Click:Connect(function()
            On = not On
            Button.BackgroundColor3 = On and Color3.fromRGB(144,0,181) or Color3.fromRGB(60,60,60)
            if callback then callback(On) end
        end)
    end

    -- ===== SLIDER (MOBILE + PC) =====
    function Window:AddSlider(text, min, max, default, callback)
        local SliderFrame = Instance.new("Frame", Main)
        SliderFrame.Size = UDim2.new(1, -12, 0, 36)
        SliderFrame.BackgroundTransparency = 1

        local Label = Instance.new("TextLabel", SliderFrame)
        Label.Size = UDim2.new(1, 0, 0, 14)
        Label.BackgroundTransparency = 1
        Label.Text = text
        Label.TextColor3 = Color3.new(1,1,1)
        Label.Font = Enum.Font.GothamBold
        Label.TextSize = 10
        Label.TextXAlignment = Left

        local Bar = Instance.new("Frame", SliderFrame)
        Bar.Position = UDim2.new(0, 0, 0, 18)
        Bar.Size = UDim2.new(1, 0, 0, 14)
        Bar.BackgroundColor3 = Color3.fromRGB(60,60,60)
        Instance.new("UICorner", Bar).CornerRadius = UDim.new(0, 6)

        local Fill = Instance.new("Frame", Bar)
        Fill.Size = UDim2.new(0, 0, 1, 0)
        Fill.BackgroundColor3 = Color3.fromRGB(144,0,181)
        Instance.new("UICorner", Fill).CornerRadius = UDim.new(0, 6)

        local dragging = false
        local value = default or min

        local function update(input)
            local percent = math.clamp(
                (input.Position.X - Bar.AbsolutePosition.X) / Bar.AbsoluteSize.X,
                0, 1
            )
            value = min + (percent * (max - min))
            Fill.Size = UDim2.new(percent, 0, 1, 0)
            if callback then callback(math.floor(value)) end
        end

        Bar.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1
            or input.UserInputType == Enum.UserInputType.Touch then
                dragging = true
                update(input)
            end
        end)

        UIS.InputChanged:Connect(function(input)
            if dragging then
                if input.UserInputType == Enum.UserInputType.MouseMovement
                or input.UserInputType == Enum.UserInputType.Touch then
                    update(input)
                end
            end
        end)

        UIS.InputEnded:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1
            or input.UserInputType == Enum.UserInputType.Touch then
                dragging = false
            end
        end)

        -- valor inicial
        local startPercent = (default - min) / (max - min)
        Fill.Size = UDim2.new(startPercent, 0, 1, 0)
    end

    return Window
end

return UILibrary
